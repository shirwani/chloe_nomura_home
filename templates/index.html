<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="{{ js_path }}"></script>
    <link rel="stylesheet" href="{{ css_path }}">
    <title>Chloe Nomura Home</title>
</head>
<body class="home-page">
    {% include 'header.html' %}

    <div class="container home-hero-container">
        <div class="row">
            <div class="col-xs-12">
                <table>
                    <tr style="vertical-align: top; padding: 20px;">
                        <td style="padding: 10px;">
                            <table class="home-hero-cta-table" style="padding: 0px;">
                                <tbody>
                                    <tr>
                                        <td style="padding: 0px;">
                                            <div class="home-hero-heading" style="padding: 0px;">Find Your Inspiration</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 0px;">
                                            <a href="{{ url_for('get_inventory') }}?trending_only=1" class="btn btn-link"><button class="btn btn-default"> <span class="glyphicon glyphicon-fire" aria-hidden="true"></span> Trending Items</button></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 0px;">
                                            <a href="{{ url_for('get_inventory') }}?hot_only=1" class="btn btn-link"><button class="btn btn-default"> <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Popular Items</button></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 0px;">
                                            <a href="{{ url_for('get_inventory') }}?discount_only=1" class="btn btn-link"><button class="btn btn-default"> <span class="glyphicon glyphicon-tag" aria-hidden="true"></span> Discounted Items</button></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 0px;">
                                            <a href="{{ url_for('get_inventory') }}" class="btn btn-link"><button class="btn btn-default"> <span class="glyphicon glyphicon-th" aria-hidden="true"></span> Browse Inventory</button></a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                        <td style="padding: 20px;">
                            <img
                            src="https://chloe-nomura-home.atl1.cdn.digitaloceanspaces.com/website-images/home_page_collage_hero.jpg"
                            alt="Chloe Nomura Home Furnishing"
                            class="img-responsive center-block home-hero-image"
                        >
                        </td>
                    </tr>   
                    </tbody>
                </table>
                <hr/>
                <div class="home-sustainability-blurb">
                    <h2 class="home-sustainability-title">
                        Give Great Furniture a Second Life
                    </h2>
                    <p class="home-sustainability-text">
                        Decorating sustainably doesn't mean sacrificing style. When you choose pre-owned over brand new, you save trees,
                        conserve energy, and keep perfectly good materials out of landfills. It’s the easiest way to make your home
                        beautiful and your lifestyle eco-friendly. Find your next treasure and feel good about where it came from.
                    </p>
                </div>
            </div>
        </div>
    </div>

    {% if top_picks %}
    <div class="container home-top-picks-container">
        <div class="row">
            <div class="col-xs-12">
                <div class="related-items-section home-top-picks-section">
                    <h3 class="related-items-title home-top-picks-heading">
                        Our Top Picks
                    </h3>
                    <div class="related-items-wrapper">
                        <button type="button"
                                class="related-scroll-arrow related-scroll-arrow-left hidden"
                                aria-label="Scroll top picks left">
                            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        </button>
                        <div class="related-items-scroll">
                            {% for r in top_picks %}
                            <div class="related-item-card">
                                <div class="related-item-image-wrapper">
                                    {% if r.image_url %}
                                    <a href="{{ url_for('product_detail', item_id=r.id) }}">
                                        <img src="{{ r.image_url }}"
                                             alt="{{ r.name }}"
                                             class="related-item-image img-responsive">
                                    </a>
                                    {% endif %}
                                </div>
                                <div class="related-item-name">
                                    <a href="{{ url_for('product_detail', item_id=r.id) }}">
                                        {{ r.name }}
                                    </a>
                                </div>
                                {% set r_has_discount = (r.original_price is not none) and (r.original_price > r.price) %}
                                <div class="related-item-price">
                                    {% if r_has_discount %}
                                        <span class="related-price-original">
                                            ${{ "%.2f"|format(r.original_price) }}
                                        </span>
                                        <span class="related-price-discount">
                                            ${{ "%.2f"|format(r.price) }}
                                        </span>
                                    {% else %}
                                        ${{ "%.2f"|format(r.price) }}
                                    {% endif %}
                                </div>
                                {% if r.description %}
                                <div class="inventory-description home-top-picks-description">
                                    {{ r.description|trim|truncate(150, True, '…') }}
                                </div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                        <button type="button"
                                class="related-scroll-arrow related-scroll-arrow-right hidden"
                                aria-label="Scroll top picks right">
                            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <br/><br/>
    
    {% if category_spotlights %}
    <div class="container home-category-container">
        <div class="row">
            <div class="col-xs-12">
                <h2 class="home-category-heading">Shop by Category</h2>
                <br/>
                <div class="home-category-grid">
                    {% for spotlight in category_spotlights %}
                    {% set cat = spotlight.category %}
                    {% set item = spotlight.item %}
                    <a href="{{ url_for('get_inventory', category=cat) }}"
                       class="home-category-card">
                        <div class="home-category-image-wrapper">
                            {% if item.image_url %}
                            <img src="{{ item.image_url }}"
                                 alt="{{ cat }}"
                                 class="home-category-image img-responsive">
                            {% endif %}
                        </div>
                        <div class="home-category-name">
                            {{ cat }}
                        </div>
                    </a>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <script>
      // Horizontal scroll arrows for the home page "Our Top Picks" section,
      // mirroring the behavior used on the product detail related-items carousel.
      (function() {
        if (typeof window.jQuery === "undefined") {
          return;
        }
        jQuery(function($) {
          $(".home-top-picks-container .related-items-wrapper").each(function () {
            var $wrapper = $(this);
            var $scroll = $wrapper.find(".related-items-scroll");
            var $left = $wrapper.find(".related-scroll-arrow-left");
            var $right = $wrapper.find(".related-scroll-arrow-right");

            if (!$scroll.length) {
              return;
            }

            function updateArrows() {
              var el = $scroll[0];
              if (!el) return;

              var scrollWidth = el.scrollWidth;
              var clientWidth = el.clientWidth;
              var scrollLeft = el.scrollLeft;

              if (scrollWidth <= clientWidth + 1) {
                $left.addClass("hidden");
                $right.addClass("hidden");
                return;
              }

              if (scrollLeft <= 0) {
                $left.addClass("hidden");
              } else {
                $left.removeClass("hidden");
              }

              if (scrollLeft + clientWidth >= scrollWidth - 1) {
                $right.addClass("hidden");
              } else {
                $right.removeClass("hidden");
              }
            }

            var scrollAmount = 220;

            $left.on("click", function (evt) {
              evt.preventDefault();
              $scroll.animate(
                { scrollLeft: $scroll.scrollLeft() - scrollAmount },
                200,
                updateArrows
              );
            });

            $right.on("click", function (evt) {
              evt.preventDefault();
              $scroll.animate(
                { scrollLeft: $scroll.scrollLeft() + scrollAmount },
                200,
                updateArrows
              );
            });

            $scroll.on("scroll", updateArrows);
            $(window).on("resize", updateArrows);

            updateArrows();
          });
        });
      })();
    </script>

    {% include 'footer.html' %}

</body>
</html>
